<!DOCTYPE html>
<html lang="no">
<head>
    <title>My Home Automation</title>
    <style>
        body {
            height: auto;
            min-height: 100%;
            background-color: #2E2E2E;
            color: #fff;
            font-family: "Source Sans Pro", "Helvetica Neue", Helvetica, Arial, sans-serif;
        }

        p, h3 {
            color: #88B252;
        }

        /*
        #88B252
        #EEC14D
        */

        #header {
            background-color: #353c42;
        }
        #main {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            padding: 20px;
        }
        .widget {
            background: white;
            padding: 15px;
            margin: 10px;
            border-radius: 8px;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
            width: 300px;
        }
        iframe {
            width: 100%;
            height: 200px;
            border: none;
        }
    </style>
</head>
<body>
   <div id="header">
    Header | Option 1 | Option 2
   </div>
   <div id="main">
   </div>

   <script>
    async function loadWidgets() {
        const response = await fetch("/widgets"); // Get list of widgets
        const widgets = await response.json();

        for (const widget of widgets) {
            const dataResponse = await fetch(widget.endpoint);
            const data = await dataResponse.json();

            const widgetDiv = document.createElement("div");
            widgetDiv.classList.add("widget");

            const title = document.createElement("h3");
            title.innerText = data.title;
            widgetDiv.appendChild(title);

            if (data.iframe) {
                const iframe = document.createElement("iframe");
                iframe.src = data.iframe;
                widgetDiv.appendChild(iframe);
            } else {
                const content = document.createElement("p");
                content.innerText = data.content;
                widgetDiv.appendChild(content);
            }

            document.getElementById("main").appendChild(widgetDiv);
        }
    }

    loadWidgets();
</script>
    
</body>
</html>